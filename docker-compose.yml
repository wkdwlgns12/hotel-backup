version: '3.8'

services:
  mongodb:
    image: mongo:6.0
    container_name: 3hotel-mongodb
    restart: always
    volumes:
      - mongodb_data:/data/db
    # ì™¸ë¶€ í¬íŠ¸ ì—°ê²° (í•„ìš” ì—†ëŠ” ê²½ìš° ì£¼ì„ ì²˜ë¦¬ ê°€ëŠ¥)
    # ports:
    #   - "27017:27017"

  backend:
    image: sunho45/3-hotel-backend:1.0
    container_name: 3hotel-backend
    restart: always
    depends_on:
      - mongodb
    
    # ğŸŒŸ ìˆ˜ì • ê¶Œì¥: .env íŒŒì¼ì„ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½
    # MONGO_URIë¥¼ ì—¬ê¸°ì— ì§ì ‘ ì„¤ì •í•˜ëŠ” ëŒ€ì‹  .env íŒŒì¼ì—ì„œ ì½ë„ë¡ í•©ë‹ˆë‹¤.
    # ì•„ë˜ env_file ì„¤ì •ì„ ì‚¬ìš©í•˜ë ¤ë©´, docker-compose.ymlê³¼ ê°™ì€ ìœ„ì¹˜ì— .env íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.
    env_file:
      - .env

    # âŒ ê¸°ì¡´ environment ì„¤ì • (ì£¼ì„ ì²˜ë¦¬)
    # environment:
    #   NODE_ENV: production
    #   MONGO_URI: mongodb+srv://<id>:<password>@hotel-project.1sd22.mongodb.net/hotel-project?appName=hotel-project
    #   PORT: 3000
    
    # ğŸŒŸ ë¡œì»¬ì—ì„œ ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ í¬íŠ¸ ì£¼ì„ í•´ì œ (3000ë²ˆ í¬íŠ¸ ì—°ê²°)
    ports:
      - "3000:3000"

  frontend:
    image: sunho45/3-hotel-frontend:1.0
    container_name: 3hotel-frontend
    restart: always
    depends_on:
      - backend
    ports:
      # 80ë²ˆ í¬íŠ¸ëŠ” w-hotel.storeë¡œ ë°”ë¡œ ì ‘ì† ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŒ
      - "80:80"

volumes:
  mongodb_data: